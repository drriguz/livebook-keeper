<p>Note that we could have re-used the <code class="code">event-stats.user-activity.updates</code> Kafka topic fed by the event stats service as it enriches the messages received from <code class="code">daily.step.updates</code> with user data, including an email address. An implementation detail in how Kafka record keys are being produced for both topics makes it simpler to enforce that at most one message is being sent to a user each day by using the records from <code class="code">daily.step.updates</code>, and then getting the email from the user profile service. This does not add much network and processing overhead either since a user must receive an email only for the first activity update with at least 10.000 steps on a given day.</p>