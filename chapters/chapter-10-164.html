<p>The query result is again a <code class="code">RowSet</code>, and we know by the SQL query that only 1 row can be returned, so we use the <code class="code">map</code> operator to extract it. The <code class="code">sendCount</code> method sends the data as a JSON document, while the <code class="code">handleError</code> method produces a HTTP 500 error. When a year or month URL parameter is not a number or does not result in a valid date then <code class="code">sendBadRequest</code> produces a HTTP 400 to let the request know of a mistake.</p>