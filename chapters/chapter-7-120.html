<p>Kafka records can be acknowledged in an automatic fashion by batches, as there is little harm in processing a record again, especially for the throughput and city trends computations. To ensure that exactly one record is being produced for an activity update, then a manual acknowledgement is possible, although an occasional duplicate record should not impact a consuming service.</p>