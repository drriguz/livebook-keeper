<p>The <code class="code">onErrorReturn</code> operator allows us to handle duplicate inserts gracefully. It is possible that after a service restart we end up replaying some Kafka events that we had already processed, so the <code class="code">INSERT</code> queries will fail since that would result in entries with duplicate primary keys. Method <code class="code">duplicateKeyInsert</code> from listing <a class="calibre8 pcalibre" href="/book/vertx-in-action/chapter-10/v-10/duplicateKeyInsert" shape="rect" title="Example 10.22. Detected a duplicate key error">10.22</a> shows how to distinguish between a duplicate key error and another technical error.</p>