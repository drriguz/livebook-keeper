<p>The <code class="code">distinct</code> combinator ensures a single event by Kafka record key right after <code class="code">filter</code>. This is to avoid sending more than one congratulation email to a user on a given day, as we could easily have a first event with, say, 10100 steps, followed later by another event with 10600 steps and so on. Note that this design is not 100% bullet-proof, as it requires storing already processed key values in memory, and upon a service restart we could accidentally send a second email. This is a reasonable trade-off with our example compared to using a persistent data store just to keep track of when an email was last sent to a user.</p>