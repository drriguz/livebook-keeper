<p>The <code class="code">groupBy</code> operator returns here a <code class="code">Flowable</code> of <code class="code">GroupedFlowable</code> of Kafka records. Each <code class="code">GroupedFlowable</code> is a flowable that is dedicated to the grouped records of a city, as dispatched by <code class="code">groupBy</code> using the <code class="code">city</code> function. For each group the <code class="code">flatMap</code> operator is then used to group event in time windows of 5 seconds, meaning that per-city steps are updated every 5 seconds. Finally the <code class="code">publishCityTrendUpdate</code> method prepares a new record with updated stats for each city, as given in listing <a class="calibre8 pcalibre" href="/book/vertx-in-action/chapter-11/v-10/publishCityTrendUpdate" shape="rect" title="Example 11.9. Publishing per-city stats">11.9</a>.</p>